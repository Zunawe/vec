<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>vecn Source: index.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.slate.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">vecn</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="vecn.html">vecn</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#isVec">isVec</a></li><li><a href="global.html#newVecType">newVecType</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: index.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript ">const assert = require('assert');

/**
 * An object for memoizing vecType functions.
 * @type {Object}
 * @private
 */
var vecTypes = {};

/**
 * A class for fixed-size vectors of numbers.
 * @extends Array
 */
class vecn extends Array{
	/**
	 * Creates a vecn of the specified dimension. This should never be called
	 * by the user (as if this were an abstract class).
	 * @param {number} dimension The dimension of this vector.
	 * @param {number[]} [args=[]] The numbers to be put in the vector.
	 */
	constructor(dimension, args){
		args = flattenOuter(args);
		assert(args.every((x) => typeof(x) === 'number'), 'All arguments must be numbers.');
		assert(args.length === 0 || args.length === 1 || args.length === dimension,
			'Argument list must be empty, have a single number, or have a length equal to the dimension.');

		if(args.length === 0){
			args = [0];
		}
		if(args.length === 1){
			args = Array(dimension).fill(args[0]);
		}

		super(...args);

		Object.defineProperties(this, {
			pop: {
				value: undefined,
				enumerable: false
			},
			push: {
				value: undefined,
				enumerable: false
			},
			shift: {
				value: undefined,
				enumerable: false
			},
			unshift: {
				value: undefined,
				enumerable: false
			}
		});
	}

	/**
	 * Gets the L2 norm (Euclidian norm) of the vector.
	 * @returns {number} The L2 norm of the vector.
	 */
	get magnitude(){
		return this.pnorm(2);
	}

	set magnitude(newVal){
		// Empty
	}

	//--------------------------------------------------------------------------
	//   Arithmetic

	/**
	 * Returns a vector where this is divided by v componentwise. If v is
	 * a single number, the vector is scaled by 1/v.
	 * @param {number|Array} v The value to multiply with.
	 * 
	 * @returns {vecn} A new vector with the divided components.
	 */
	div(v){
		assert(v.length === this.dim || typeof(v) === 'number', 'Argument must be a scalar or of the same dimension.');
		if(typeof(v) === 'number'){
			v = Array(this.dim).fill(v);
		}
		return vecTypes[this.dim](this.pow(-1).times(v).pow(-1));
	}

	/**
	 * Returns a vector where v is subtracted from the components of this
	 * vector. If v is a single number, it is subtracted to each component. If v
	 * is a vector, the vectors are combined componentwise.
	 * @param {number|Array} v The value to subtract from this vector.
	 * 
	 * @returns {vecn} A new vector with the combined components.
	 */
	minus(v){
		assert(v.length === this.dim || typeof(v) === 'number', 'Argument must be a scalar or of the same dimension.');
		if(typeof(v) === 'number'){
			v = Array(this.dim).fill(v);
		}
		return vecTypes[this.dim](this.neg().plus(v).neg());
	}

	/**
	 * Negates each element in this vector.
	 * @returns {vecn} A new vector where all elements are negated.
	 */
	neg(){
		return vecTypes[this.dim](this.times(-1));
	}

	/**
	 * Returns a vector where v is added to the components of this vector. If v
	 * is a single number, it is added to each component. If v is a vector, the
	 * vectors are added componentwise.
	 * @param {number|Array} v The value to add to this vector.
	 * 
	 * @returns {vecn} A new vector with the summed components.
	 */
	plus(v){
		assert(v.length === this.dim || typeof(v) === 'number', 'Argument must be a scalar or of the same dimension.');
		if(typeof(v) === 'number'){
			v = Array(this.dim).fill(v);
		}
		return vecTypes[this.dim](this.map((x, i) => x + v[i]));
	}

	/**
	 * Returns a vector where each component of this was raised to a power p.
	 * @param {number} p The power to raise each component by.
	 * 
	 * @returns {vecn} A new vector with the exponentiated components.
	 */
	pow(p){
		return vecTypes[this.dim](this.map((x) => Math.pow(x, p)));
	}

	/**
	 * Returns a vector where v and this are multiplied componentwise. If v is
	 * a single number, the vector is scaled by v.
	 * @param {number|Array} v The value to multiply with.
	 * 
	 * @returns {vecn} A new vector with the multiplied components.
	 */
	times(v){
		assert(v.length === this.dim || typeof(v) === 'number', 'Argument must be a scalar or of the same dimension.');
		if(typeof(v) === 'number'){
			v = Array(this.dim).fill(v);
		}
		return vecTypes[this.dim](this.map((x, i) => x * v[i]));
	}

	//--------------------------------------------------------------------------
	//   Vector Operations

	/**
	 * Dots two vectors.
	 * @param {Array} v The vector to dot with this one.
	 * 
	 * @returns {number} The dot product between this and v.
	 */
	dot(v){
		assert(v.length === this.dim, 'Argument must be of the same dimension.');
		if(typeof(v) === 'number'){
			v = Array(this.dim).fill(v);
		}
		return this.reduce((acc, x, i) => acc + (x * v[i]), 0);
	}

	/**
	 * Scales this vector to a magnitude of 1.
	 * 
	 * @returns {vecn} A new vector with scaled components.
	 */
	normalize(){
		return vecTypes[this.dim](this.div(this.magnitude));
	}

	/**
	 * Evaluates the p-norm (or lp-norm) of this vector.
	 * @param {number} p The p-value to evaluate.
	 * 
	 * @returns {number} The norm of this vector.
	 */
	pnorm(p){
		return Math.pow(this.map(Math.abs).pow(p).sum(), 1 / p);
	}

	//*************************************************************************
	//   Extras

	/**
	 * Finds the indices of the max value in this vector.
	 * 
	 * @returns {Array} An array of indices corresponding to the max values.
	 */
	argmax(){
		var maxVal = this.max();
		return this.reduce((acc, n, i) => n === maxVal ? acc.concat([i]) : acc, []);
	}

	/**
	 * Finds the indices of the min value in this vector.
	 * 
	 * @returns {Array} An array of indices corresponding to the min values.
	 */
	argmin(){
		var minVal = this.min();
		return this.reduce((acc, n, i) => n === minVal ? acc.concat([i]) : acc, []);
	}

	/**
	 * Creates a new vector from the provided indices of this one. Basically
	 * equivalent to swizzling.
	 * @param {Array} indices The indices to select into a new vector.
	 * 
	 * @returns {vecn} A new vector from the provided indices.
	 */
	choose(indices){
		var v = [];
		indices.forEach((i) => v.push(this[i]));
		return vecTypes[v.length](v);
	}

	/**
	 * Returns the max value of this vector.
	 * 
	 * @returns {number} The max value of this vector.
	 */
	max(){
		return Math.max(...this);
	}

	/**
	 * Returns the min value of this vector.
	 * 
	 * @returns {number} The min value of this vector.
	 */
	min(){
		return Math.min(...this);
	}

	/**
	 * Sums the components of this vector.
	 * 
	 * @returns {number} The sum of the components of this vector.
	 */
	sum(){
		return this.reduce((acc, n) => acc + n, 0);
	}

	//--------------------------------------------------------------------------
	//   Array Overrides

	/**
	 * Same as Array.prototype.concat, but always returns an Array.
	 */
	concat(...values){
		return super.concat(...values).toArray();
	}

	/**
	 * Same as Array.prototype.filter, but always returns an Array.
	 */
	filter(callbackfn){
		return super.filter(callbackfn).toArray();
	}

	/**
	 * Same as Array.prototype.concat, but if the result does not contain only
	 * numbers, returns an Array instead.
	 */
	map(...args){
		var result = super.map(...args);
		if(result.every((n) => typeof(n) === 'number')){
			return result;
		}
		return result.toArray();
	}

	/**
	 * Same as Array.prototype.slice, but always returns an Array.
	 */
	slice(...args){
		return super.slice(...args).toArray();
	}

	/**
	 * Same as Array.prototype.splice, but always returns an Array.
	 */
	splice(...args){
		return super.splice(...args).toArray();
	}

	/**
	 * Converts this vector into an Array.
	 */
	toArray(){
		return Array.from(this);
	}
}

/**
 * The validator to be used in the proxy for all vec objects. Catches swizzling
 * accessors and blocks Array functions that change the length or magnitude
 * properties.
 * @type {Object}
 * @private
 */
var validator = {
	set: function (obj, prop, value){
		if(prop === 'length'){
			return false;
		}

		obj[prop] = value;
		return true;
	},
	get: function (obj, prop){
		if(obj.dim &lt;= 4 &amp;&amp; prop.toString().split('').every((c) => c in namedIndices)){
			return swizzle(obj, prop);
		}

		return obj[prop];
	}
};

/**
 * Returns a factory function for vectors of the specified dimension.
 * @param {number} dim The dimension of the new vector type.
 * 
 * @returns {Function} A factory (not a constructor) for creating new vecs.
 */
function newVecType(dim){
	var dim = Number(dim);

	if(!(dim in vecTypes)){
		assert(!isNaN(dim), 'dimension must be coercible to a number.');
		assert(dim > 1, 'dimension must be greater than 1.');
		assert(Number.isInteger(dim), 'dimension must be an integer.');

		// Doing a little big of exploiting ES6 to dynamically name the class
		var classname = 'vec' + dim;
		var vecType = ({[classname]: class extends vecn{
			constructor(...args){
				if(args.length === 1 &amp;&amp; args[0] instanceof vecn){
					assert(args[0].dim &lt;= dim);
					args = promoteArrayDimension(args[0].toArray(), dim);
				}
				super(dim, args);
				Object.defineProperty(this, 'dim', {
					value: dim,
					writable: false,
					enumerable: false
				});
			}
		}})[classname];

		vecTypes[dim] = function (...args){
			var target = new vecType(...args);
			Object.preventExtensions(target);
			return new Proxy(target, validator);
		};
	}

	return vecTypes[dim];
}

/**
 * The correct function for determining whether an object is a vecn.
 * @param {*} v The object in question.
 * 
 * @returns {boolean} True if the object is an instance of vecn.
 */
function isVec(v){
	return v instanceof vecn;
}

/**
 * The index corresponding to common names for indexing vectors.
 * @constant
 * @type {Object}
 * @private
 */
const namedIndices = {
	x: 0,
	y: 1,
	z: 2,
	w: 3
};

/**
 * Swizzles a vecn and returns the resulting vector.
 * @private
 * @param {vecn} v The vector to pull data from. The dimension is assumed to be
 * 2, 3, or 4, but this isn't enforced here.
 * @param {string} s The property being used to swizzle (e.g. 'xxy' or 'z').
 * 
 * @returns {undefined|number|vecn} Either undefined (if s isn't a valid swizzle
 * string), a number (if s has a length of 1), or a vecn where the values have
 * been rearranged according to the order given in s.
 */
function swizzle(v, s){
	var dim = v.dim;
	var newDim = s.length;

	if(newDim === 1){
		return v[namedIndices[s]];
	}

	var vecType = newVecType(newDim);

	var values = s.split('').reduce((acc, x) => {
		var i = namedIndices[x];
		return acc &amp;&amp; i &lt; v.dim ? acc.concat([v[i]]) : undefined;
	}, []);
	return values ? new vecType(...values) : values;
}

/**
 * Checks whether a provided string can be used as a valid index into an array.
 * @private
 * @param {string} n A string representation of the number in question.
 * 
 * @returns {boolean} True if n can be used to index an array.
 */
function isIndex(n){
	return !isNaN(n) &amp;&amp;
	       Number(n).toString() === n &amp;&amp;
	       Number.isInteger(Number(n)) &amp;&amp;
	       Number(n) >= 0;
}

/**
 * Lengthens an exsting array and fills new entries with 0 (does not mutate).
 * @private
 * @param {Array} arr The source array.
 * @param {number} dim The dimension of the new array.
 * 
 * @returns {Array} A new array with length dim and arr as a prefix.
 */
function promoteArrayDimension(arr, dim){
	return [...Array(dim)].map((_, i) => i &lt; arr.length ? arr[i] : 0);
}

function flattenOuter(arr){
	if(!(arr instanceof Array) || arr.length !== 1){
		return arr;
	}
	if(arr[0] instanceof Array){
		return flattenOuter(arr[0]);
	}
	return arr;
}

newVecType(2);
newVecType(3);
newVecType(4);

module.exports = {
	newVecType,
	isVec,
	vec2: vecTypes[2],
	vec3: vecTypes[3],
	vec4: vecTypes[4]
};
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	vecn Copyright © 2018 Bryce Wilson
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
	
		on Wed May 23rd 2018
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>
